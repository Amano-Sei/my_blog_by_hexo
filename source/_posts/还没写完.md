---
title: 还没写完
cwd: hexo/myblog
date: 2020-08-02 00:24:54
tags:
- 日常
- csapp
---

毕竟不好好写代码有段时间了，码力下降的厉害...

不过比较麻烦的推迟合并写好了，和必要的数据结构也构思好了。

为了能让前驱后驱指针存在32位里，我保存的是相对于`mem_start_brk`的距离，看到有些dalao直接把`void *`强转`unsigned`...不知道他们是不是运行在32位环境下的...

但是就是这样，最小块大小也扩大到了16字节，但是想要分离适配我也着实想不到什么其他不用显式链表的方法。

不过因为是推迟合并其实可以省去空闲块尾部，但是又有双字对齐，所以依然还是16字节跑不掉。

但是加上尾部可以在不扫描整个堆而只扫描free list的情况下的常数级合并，所以还是加上尾部了。

刚才我又瞎想了下，因为指针也是8字节对齐的，所以我们可以利用指针的倒数第3位创建没有首部和尾部的空闲块，但是判断会变得更多更繁复...不过感觉不值得为了可能是少部分的需求加大其他部分的常数。

明天再继续...

