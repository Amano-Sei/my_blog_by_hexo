---
title: 关于次优最小生成树
cwd: hexo/myblog
date: 2020-09-30 21:21:04
tags:
- 最小生成树
---

update:（这篇博客是我第一次写这种长篇大论，但是当时还没有装hexo filter mathjax，然而这使得即使是我自己再重新阅读都会感觉非常吃力...所以有时间会更新成用latex公式的版本）

次优最小生成树\(second-best minimum spanning tree\)是来自算法导论上的翻译，其实也就是我们常说的次小生成树。

最小生成树想必大家都很熟了，次小生成树的解答需要用到一条结论:

> 设T为G=\(V, E\)的一棵最小生成树，图G包含边\(u, v\)∈T，\(x, y\)∉T'使得T-\{\(u,v\)\}∪\{\(x, y\)\}是G的一颗次优最小生成树。

\(以上是直接从算法导论证明题题面上直接抄下来的\)

首先对这个结论的解释，T'只是说存在这样一棵次优最小生成树，但是不代表所有的次优最小生成树都可以经由某棵确定的最小生成树得来。容易构造这样一个例子，一个8字形每个直角处都有一个点且每条边长度都相等的图，他的最小生成树可以是H形的也可以是E字形的，显然两者差了不止一条边。我们参考算法导论上的对于所有边都不等情况下的证明对这个结论进行证明。

> 因为所有生成树都有|V|-1条边，而次优最小生成树一定最少有一条边不在最小生成树中。如果次优最小生成树中有一条边\(x, y\)不在最小生成树中，那么\(x, y\)肯定替换了最小生成树中的某条边，我们假定他是\(u, v\)。在这种情况下，T' = T-\{\(u, v\)\}∪\{\(x, y\)\}，正如我们想要证明的那样。
> 因此，我们需要做的就是证明替换最小生成树中的边替换入次优最小生成树得到的权值是不会大于次优最小生成树的。假定存在一个次优最小生成树T'与T有k\(k\>1\)条边不同，也就是最少有2条边在T-T'中，我们设\(u, v\)是T-T'中最小的边\(如果最小的边有复数个，则任选其一\)，如果我们把\(u, v\)添加到T'中，那么我们会得到一个环c。c中一定包含了在T'-T中的某条边\(x, y\)\(否则，会因为T包含c中所有的边导致T中有环\)。
> 我们可以证明w\(x, y\) \>= w\(u, v\)。用反证法，假如w\(x, y\) \< w\(u, v\)。如果我们把\(x, y\)加入到T中，我们会得到一个环c'，他必然包含T-T'中的某条边\(u', v'\)\(否则，会因为T'包含c'中所有的边导致T'中有环\)。那么T'' = T-\{\(u', v'\)\}∪\{\(x, y\)\}会形成一棵生成树，并且一定有w\(u', v'\) \<= w\(x, y\)，否则T''将会拥有比T还小的权值。因此我们有w\(u', v'\) \<= w\(x, y\) \< w\(u, v\)，这与我们设\(u, v\)是T-T'中最小的边矛盾。
> 如果我们把\(u, v\)添加到T'中，那么\(u, v\)和\(x, y\)都在环c上，那么T'-\{\(x, y\)\}∪\{\(u, v\)\}就是一棵有着小于等于T'的权值的生成树，与T有最少一条边不同，由T'是次优最小生成树，那么我们就有T''的权值与T'相同，即T''也是次优最小生成树。
> 我们可以重复上述操作，每轮操作结束后得到的都是一棵次优最小生成树，且每次都会和最小生成树少差一条边。我们可以重复操作直到得到的次优最小生成树与最小生成树只差一条边，即如果次优最小生成树存在则一定存在一棵和最小生成树只差一条边次优最小生成树。

\(以上是对算法导论指导者手册上对23-1b的证明进行翻译和修改得来的\)

我们可以通过增加条件来证明一些其他的结论。

如果最小生成树唯一，那么我们就可以证明w\(x, y\)\>w\(u, v\)，最终会使得T''是优于T'的一棵生成树且与T有至少一条边不同，这与T'是次优最小生成树矛盾，即这种情况下次优最小生成树只能和最小生成树差一条边。

我们还可以证明任意一棵次小生成树一定是由某棵最小生成树转化而来。首先最小生成树唯一的时候前一条结论已经可以证明了，而当最小生成树不唯一时，即次小生成树就是最小生成树。取任意两个有最少两条边以上不同的最小生成树T和T'，我们取\(T-T'\)∪\(T'-T\)中最小的边t，不妨令t∈\(T-T'\)，则我们把t插入到T'中，替换掉\(T'-T\)中的t'，则由w\(t\) <= w\(t'\)可知T''=T'-\{t'\}∪\{t\}有着不大于T'的权值，则T''是与T'只差一条边的最小生成树，与T差|T-T'|-1条边的最小生成树，则T'得证。而T和T''重复上述直到或是T直接得证或是得到与T差|T-T'|-\(|T-T'|-1\)条边的最小生成树得证。

这里有另一个更符合这篇博客基本思想的证法，我们取t为\(T-T'\)中最小的一条边，把它插入T'替换掉t'，首先因为最小生成树的性质T''=T'-\{t'\}∪\{t\}，T''会有着大于等于T'的权值，则有w\(t\)\>=w\(t'\)，又同前面的反证可以得到w\(t'\)\>=w\(t\)，所以w\(t\)=w\(t'\)，所以我们可以重复上述操作得到一棵与T差|T-T'|-\(|T-T'|-1\)条边的最小生成树。

严格次小生成树同样要分为两部分，一部分是若存在严格次小生成树则任意最小生成树一定存在可以只替换一条边得到的严格次小生成树，另一部分是任意严格次小生成树都可以经由某棵最小生成树得来。

　我们先来看第一部分，假设存在最小生成树T和严格次小生成树T'，且两者存在至少2条边不同，u是T-T'中最小的边中的一条，设u添加到T'中形成的环为c，替换掉的是x∈\(T'-T\)∩c，则同上我们可以得到w\(u\) \<= w\(x\)，则有w\(u\)要么等于w\(x\)，要么小于w\(x\)。我们进一步分情况来看。

　　w\(u\) = w\(x\)时，我们有T''=T'-\{x\}∪\{u\}权值与T'相同，即T''也是一棵严格次小生成树，而T''与T的不同边数为\(|T-T'|-1\)

　　w\(u\) \< w\(x\)时，我们有T''=T'-\{x\}∪\{u\}权值比T'小，且与T有最少一条边不同，则由于T'是严格次小生成树，T''就必须是最小生成树了，即w\(T'\)-w\(x\)+w\(u\)=T\(T\)。需要注意我们的目的是为了得到一个与T较T'少差一条边的严格次小生成树，所以我们只会在c∩\(T'-T\)上只有权等于w\(x\)的边时候才会替换x，需要注意可以根据前面的证明我们知道属于c∩\(T'-T\)的边权值要么等于w\(u\)，要么等于这里的w\(x\)。此时我们重复前述操作，取新的u'是T-T''\(等于T-T'-\{u\}\)中最小的边，设u'插入T''中得到的环为c'，替换掉的边为x'∈\(T''-T\)∩c'，因为T''是最小生成树，易得w\(u'\)=w\(x'\)，新的最小生成树T'''=T''-\{x'\}∪\{u'\}。

　　　当x'不是c上的边时，我们把x插入T'''再次得到环c，然后我们可以替换掉u，得到T''''=T'''-\{u\}∪\{x\}=T''-\{x'\}∪\{u'\}-\{u\}∪\{x\}=T'-\{x'\}∪\{u'\}，显然T''''具有和T'相等的权值是一棵严格次小生成树且与T相差\(|T-T'|-1\)条边。

　　　再看x'是c上的边的情况，首先我们有w\(x'\)=w\(x\)=w\(u'\)，然后这里可以根据从u'两端沿着c'出发第一次碰到c上的点的分布分为两种情况。这里有两个前提，首先是u'一定不在c中，因为u'在T-T'中不可能出现在T'∪\{u\}的子集c中; 其次是因为x'∈c和x'∈c'，所以c和c'交集非空，即两者一定相交。\(其实这里就是我感觉自己哪里不严谨...\)

　　　　两点分布在u和x在c上的一侧。显然x'一定在两个交点之间的路径上，而这条路径也一定在同一侧。那么这种情况下我们插入x到T'''中，会得到一个从x到交点1到u'到交点2到u到x的环，这里我们替换掉u，即得到T''''=T'''-\{u\}∪\{x\}，这是一棵与T'权值相等的严格次小生成树，且与T相差\(|T-T'|-1\)条边。

　　　　两点分布在u和x在c上的两侧。同上x'一定在两个交点之间的路径上，这条路径一定经过u。那么这种情况下我们插入x'到T'''中，会得到一个从u'到交点1到u到x'到交点2再到u'的环，这时我们替换掉u，即得到T''''=T'''-\{u\}∪\{x'\}=T''-\{u\}∪\{u'\}=T'-\{x\}∪\{u'\}，我们有w\(x\)=w\(u'\)，所以T''的权值与T'相等是一棵严格次小生成树，且与T相差\(|T-T'|-1\)条边。

　我们重复上述操作直到得到一棵与T相差\[|T-T'|-\(|T-T'|-1\)\]条边的严格次小生成树。

至此若存在严格次小生成树，则任意最小生成树一定存在一棵与他只差一条边的严格次小生成树得证。

　然后我们看第二部分，任意严格次小生成树一定存在一棵与他只差一条边的最小生成树。

　　假设存在最小生成树T和严格次小生成树T'，且两者存在2条边不同。u是T-T'中最小的边中的一条，我们把u插入T'中，替换掉的x∈\(T'-T\)，得到新的生成树T''=T'-\{x\}∪\{u\}。类似第一部分我们可以得到w\(u\)要么等于w\(x\)要么小于w\(x\)且插入会使得T''变为最小生成树。

　　　当w\(u\)=w\(x\)时，我们把x插入T中，替换掉u'∈\(T-T'\)，得到生成树T'''=T-\{u'\}∪\{x\}，因为T是最小生成树，所以我们有w\(x\)\>=w\(u'\)我们知道u是\(T-T'\)中最小的边中的一条，所以我们有w\(u\)\<=w\(u'\)，则w\(x\)\<=w\(u'\)，则w\(x\)=w\(u'\)，即T'''是一棵最小生成树，且T'''与T'相差\(|T-T'|-1\)条边。

　　　当w\(u\)\<w\(x\)时，即T''是一棵最小生成树\(证明见严格次小生成树第一部分的证明\)，且T''与T'只差1条边。

　　我们重复上述操作，直到连续通过第一种情况得到一棵与T'差\[|T-T'|-\(|T-T'|-1\)\]条边的最下生成树，要么直接通过第二种情况得到一棵与T'只差1条边的最小生成树。

至此第二部分得证。

上述就是我能想到和我能证明的所有结论了，卡了我足足三天有余，能完整搞完真是太开心了。如果有错误恳请指出，如果在我能力范围内我一定会进行修正的。

